# DeadlockFuzzer

The `deadlockfuzzer` program is a tool designed to test multithreaded applications for potential deadlocks through
automated fuzzing techniques. This README provides instructions for running and using the updated version of the
program.

## Features

- Updated version for java 1.8 compatability of the original [deadlockfuzzer](https://github.com/ksen007/calfuzzer)
- Flexible execution via Apache Ant or Python scripts.
- Logging of test results into output files.
- Summarization of test results into CSV format for analysis.

## Usage

### 1. Running the Program

The `deadlockfuzzer` program expects a java 8 jdk in your JAVA_HOME environment variable
and can be executed in two ways:

#### a. Using Apache Ant Target

To run the program directly with Apache Ant, use the `run.xml` file and invoke the `deadlockfuzzer` target. This can be
done with the following command:

```bash
ant -f run.xml deadlockfuzzer
```

#### b. Using the Python Script (`run.py`)

Alternatively, you can run the program using the `run.py` script. This script indirectly calls the Apache Ant
configuration and offers additional argument options. For a list of available options, use the `help` command:

```bash
python run.py --help
```

This script also allows for more customization and advanced usage, making it the preferred option for most users.

### 2. Analyzing Results

Results generated by `run.py` are written into log files located in the `outfiles` directory. To compile these results
into a summarized `.csv` file for further analysis, use the `compile_results.py` script:

```bash
python compile_results.py
```

The CSV file will provide a concise overview of the test results.

## Recommended Execution Environment

The recommended environment for running `deadlockfuzzer` is [IntelliJ IDEA](https://www.jetbrains.com/idea/) with
the [Apache Ant plugin](https://plugins.jetbrains.com/plugin/23025-ant). This setup simplifies the execution and
management of Apache Ant targets and offers an intuitive interface for managing the project.
If running the ant targets via the IDE, it is crucial to set the correct SDK (version 1.8) and the sdk default language
level under `File > Project Structure > Project` and set the same sdk under `module settings`

## Directory Structure

- **run.xml**: The Apache Ant build configuration file.
- **run.py**: Python script to run the program with additional options.
- **compile_results.py**: Python script to summarize results into a CSV file.
- **outfiles/**: Directory where log files are saved.
- **test/**: Directory where the tests which are executed during the execution of the deadlockfuzzer target reside in

## Example Workflow

1. Run the program using the `run.py` script:
   ```bash
   python run.py --iterations 3
   ```
   (Replace `--iterations` with your desired options.)

2. Analyze results by compiling them into a CSV file:
   ```bash
   python compile_results.py
   ```

3. Review the CSV file for insights and further analysis.

## Known Problems

1. Currently, the `--record` option for the run.py script is not working as intended - this needs to be fixed

## Limitations

1. The compile_results.py functionality is working but not very useful, the amount of information written into the
   csv-files could be improved upon. The threads which deadlocked and maybe which statements were responsible for it
   would be valuable information.
2. The program cannot accept arbitrary java programs but has, in its current state, defined tests. For this program to
   accept arbitrary java programs as input, those programs would have to be processed in similar fashion as the
   tests under `test/benchmarks/testcases`
3. This program was updated to java 8, however java 9 with its module update broke
   the [soot](https://github.com/soot-oss/soot) compatability in multiple ways; the jvm api changes broke the current
   soot code and the module update changed the java directory structure. As soot is currently only partially supporting
   Java 9 modules, this proved to be a task too difficult to complete with the assigned time for the project.
4. The file `lib/rt.jar` is still from java 1.6, as this was necessary for soot compatability. When migrating from java
   8 to 9, there is a high chance for rt.jar to break, as it has legacy runtime objects.
5. Run targets other than `deadlockfuzzer` (e.g. `racefuzzer`) are not supported with the current run.py and
   compile_results.py script. They can be added analogous to the `deadlockfuzzer` though.
